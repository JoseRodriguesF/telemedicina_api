generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id           Int         @id @default(autoincrement())
  email        String      @unique @db.VarChar(255)
  senha_hash   String?     @db.VarChar(255)
  google_id    String?     @unique @map("google_id") @db.VarChar(255)
  registroFull Boolean     @default(false) @map("registro_full")
  tipo_usuario TipoUsuario
  medico       Medico?
  paciente     Paciente?

  @@map("usuarios")
}

model Paciente {
  id                   Int      @id @default(autoincrement())
  usuario_id           Int      @unique
  nome_completo        String   @db.VarChar(255)
  data_nascimento      DateTime @db.Date
  cpf                  String   @unique @db.VarChar(14)
  sexo                 String   @db.VarChar(20)
  estado_civil         String   @db.VarChar(50)
  endereco             String
  telefone             String   @db.VarChar(11)
  numero               Int
  complemento          String?  @db.Text
  responsavel_legal    String?  @db.VarChar(255)
  telefone_responsavel String?  @db.VarChar(20)
  convenio             String?  @db.VarChar(255)
  numero_carteirinha   String?  @db.VarChar(50)
  usuario              Usuario  @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@map("pacientes")
}

model Medico {
  id                          Int      @id @default(autoincrement())
  usuario_id                  Int      @unique
  nome_completo               String   @db.VarChar(255)
  data_nascimento             DateTime @db.Date
  cpf                         String   @unique @db.VarChar(14)
  sexo                        String?  @db.VarChar(20)
  crm                         String   @db.VarChar(50)
  diploma_url                 String?  @db.VarChar(255)
  especializacao_url          String?  @db.VarChar(255)
  assinatura_digital_url      String?  @db.VarChar(255)
  seguro_responsabilidade_url String?  @db.VarChar(255)
  usuario                     Usuario  @relation(fields: [usuario_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@map("medicos")
}

enum TipoUsuario {
  medico
  paciente

  @@map("tipo_usuario_enum")
}
